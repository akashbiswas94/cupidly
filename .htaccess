RewriteEngine On

# --- MIME types ---
AddType image/png .png
AddType image/jpeg .jpg .jpeg

# --- Force HTTPS ---
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# --- Allow all countries, networks, and crawlers ---
<IfModule mod_headers.c>
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, HEAD, OPTIONS"
</IfModule>

# --- Explicitly allow social media bots ---
<IfModule mod_setenvif.c>
    SetEnvIfNoCase User-Agent "facebookexternalhit" good_bot
    SetEnvIfNoCase User-Agent "Facebot" good_bot
    SetEnvIfNoCase User-Agent "Twitterbot" good_bot
    SetEnvIfNoCase User-Agent "LinkedInBot" good_bot
    SetEnvIfNoCase User-Agent "WhatsApp" good_bot
</IfModule>

# --- Disable ModSecurity for crawlers (critical for 418) ---
<IfModule mod_security.c>
    SecRuleEngine Off
</IfModule>

# --- Explicitly allow all traffic ---
<IfModule mod_authz_core.c>
    Require all granted
</IfModule>
